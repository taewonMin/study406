<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
			PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
			"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="board">

	<resultMap class="board" id="boardMap">
		<result property="boardGroup" column="BOARD_GROUP"/>
		<result property="boardNo" column="BOARD_NO"/>
		<result property="boardTitle" column="BOARD_TITLE"/>
		<result property="boardContent" column="BOARD_CONTENT"/>
		<result property="boardDate" column="BOARD_DATE"/>
		<result property="memId" column="MEM_ID"/>
		<result property="boardCnt" column="BOARD_CNT"/>
		<result property="boardTag" column="BOARD_TAG"/>
	</resultMap>

	<select id="selectBoardList" resultMap="boardMap">
		select * 
		 from board
		where 1=1
	      and board_group = #boardGroup#
		<isNotEmpty property="searchType">
			<isNotEmpty property="keyword">
			   and #searchType# like '%' || #keyword# || '%' 
			</isNotEmpty>
		</isNotEmpty>
		 order by board_no desc
	</select>
	
	<select id="getBoardListCnt" resultClass="int">
		select count(*)
		  from board
		 where 1=1
		   and board_group = #boardGroup#
		<isNotEmpty property="searchType">
			<isNotEmpty property="keyword">
		   and #searchType# like '%' || #keyword# || '%' 
			</isNotEmpty>
		</isNotEmpty>
	</select>

	<select id="getBoardNextNo" resultClass="int">
		select max(board_no) from board
	</select>
	
	<insert id="insertBoard">
		insert into board(board_no,board_group,board_title,board_content,board_date,mem_id,board_cnt)
		values(#boardNo#,#boardGroup#,#boardTitle#,#boardContent#,now(),#memId#,#boardCnt#)
	</insert>
	
	<select id="getBoard" resultMap="boardMap">
		select * from board 
		 where board_no = #boardNo#
	</select>
	
	<update id="modifyBoard">
		update board 
		   set board_title = #boardTitle#,
		   	   board_content = #boardContent#,
		   	   board_cnt = #boardCnt#
		 where board_no = #boardNo#	
	</update>
	
	<delete id="removeBoard">
		delete from board 
		 where board_no = #boardNo#
	</delete>
	
	<select id="getSubjectName" resultClass="String">
		select distinct sub_parent_name
		  from subject
		 where sub_parent_code = #boardGroup#
	</select>
	
	<select id="selectBoardSearchList" resultMap="boardMap">
		
		select * from board
		
		  <isEqual property="searchType" compareValue="all">
		 where board_title like CONCAT('%',#keyword#,'%')
		    or board_content like CONCAT('%',#keyword#,'%')
		    or board_tag like CONCAT('%',#keyword#,'%')
		  </isEqual>
		  <isEqual property="searchType" compareValue="board_title">
		  where board_title like CONCAT('%',#keyword#,'%')
		  </isEqual>
		  <isEqual property="searchType" compareValue="mem_id">
		  where mem_id like CONCAT('%',#keyword#,'%')
		  </isEqual>
		  <isEqual property="searchType" compareValue="board_content">
		  where board_content like 'CONCAT('%',#keyword#,'%')
		  </isEqual>
		  <isEqual property="searchType" compareValue="board_tag">
		  where board_tag like CONCAT('%',#keyword#,'%')

		  </isEqual>
		  
	</select>
	
	
</sqlMap>